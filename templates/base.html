<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC"
      crossorigin="anonymous"
    />
    <link rel="stylesheet" href="nav.html"/>
    <title></title>

    <script>
      // Register the OneSignal service worker
      if ('serviceWorker' in navigator) {
        navigator.serviceWorker.register('/static/js/OneSignalSDKWorker.js', {
          scope: '/' // Register with root scope
        })
        .then(function(registration) {
          console.log('Service Worker registered with scope:', registration.scope);
        })
        .catch(function(error) {
          console.log('Service Worker registration failed:', error);
        });
      }

      window.OneSignalDeferred = window.OneSignalDeferred || [];
      OneSignalDeferred.push(async function(OneSignal) {
        await OneSignal.init({
          appId: "64d777b1-729d-4329-9477-46ea8257680a", // Your OneSignal App ID
          safari_web_id: "web.onesignal.auto.09714a24-a3bb-414f-8109-d75a4f07e6fa", // Safari Web ID
          notifyButton: {
            enable: true,  // Make sure the notify button is enabled
          },
          allowLocalhostAsSecureOrigin: true,  // Allow localhost as secure origin for testing
        });
      });
      OneSignal.push(function() {
         OneSignal.showHttpPrompt();
      });
    </script>

  </head>
  <body>
    {% include 'nav.html' %}
    <div class="container" style="margin-top: 73px;">
      {% for m in get_flashed_messages() %}
        <div class="alert alert-warning alert-dismissible fade show" role="alert">
          {{ m }}          
          <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
        </div>
      {% endfor %}
    
      {% block content %}
      {% endblock %}
    </div>
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
      crossorigin="anonymous"
    ></script>
  </body>
</html>
